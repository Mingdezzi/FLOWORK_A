<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>판매현황</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.3/dist/journal/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container my-4">
        {% include '_header.html' %}
        {% include '_navigation.html' %}
        <div class="card mb-3">
            <div class="card-header">판매 조회</div>
            <div class="card-body bg-light">
                <form method="GET" action="{{ url_for('sales.sales_record_view') }}" class="row g-2">
                    <div class="col-auto"><input type="date" name="start_date" class="form-control" value="{{ start_date }}"></div>
                    <div class="col-auto"><input type="date" name="end_date" class="form-control" value="{{ end_date }}"></div>
                    <div class="col-auto"><button type="submit" class="btn btn-primary">조회</button></div>
                    <div class="col-auto ms-auto"><a href="{{ url_for('product.api_export_daily_sales', date=end_date) }}" class="btn btn-success btn-sm">엑셀</a></div>
                </form>
            </div>
        </div>
        <div class="row g-3 mb-3">
            <div class="col-md-4"><div class="card bg-primary text-white"><div class="card-body text-center"><h5>판매금액</h5><p class="fs-4 fw-bold">{{ "{:,d}".format(total_summary.total_amount) }}원</p></div></div></div>
            <div class="col-md-4"><div class="card bg-info text-white"><div class="card-body text-center"><h5>할인금액</h5><p class="fs-4 fw-bold">{{ "{:,d}".format(total_summary.total_discount) }}원</p></div></div></div>
            <div class="col-md-4"><div class="card bg-success text-white"><div class="card-body text-center"><h5>영수건수</h5><p class="fs-4 fw-bold">{{ "{:,d}".format(total_summary.total_count) }}건</p></div></div></div>
        </div>
        <div class="card">
            <div class="table-responsive">
                <table class="table table-hover text-center">
                    <thead class="table-dark"><tr><th>일시</th><th>영수번호</th><th>결제</th><th>금액</th><th>구분</th><th>상태</th><th>상세</th></tr></thead>
                    <tbody>
                        {% for s in sales %}
                        <tr>
                            <td>{{ s.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                            <td>{{ s.receipt_number }}</td>
                            <td>{{ s.payment_method }}</td>
                            <td>{{ "{:,d}".format(s.total_amount) }}</td>
                            <td>{{ '온라인' if s.is_online else '오프라인' }}</td>
                            <td>{{ '환불' if s.status=='refunded' else '정상' }}</td>
                            <td><a href="{{ url_for('sales.sales_detail_view', sale_id=s.id) }}" class="btn btn-sm btn-outline-secondary">보기</a></td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>