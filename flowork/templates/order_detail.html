<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>주문상세</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.3/dist/journal/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
</head>
<body data-product-lookup-url="{{ url_for('product.api_find_details') }}" 
      data-product-search-url="{{ url_for('product.api_order_search') }}">
    <div class="container my-4">
        {% include '_header.html' %}
        {% include '_navigation.html' %}

        <div class="card">
            <div class="card-header">주문 상세</div>
            <form method="POST" id="order-form">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <div class="card-body">
                    <div class="row">
                        <div class="col-6"><label>고객명</label><input type="text" class="form-control" name="customer_name" value="{{ order.customer_name if order else '' }}"></div>
                        <div class="col-6"><label>연락처</label><input type="text" class="form-control" name="customer_phone" value="{{ order.customer_phone if order else '' }}"></div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-4">
                            <label>품번</label>
                            <input type="text" class="form-control" id="product_number" name="product_number" value="{{ order.product_number if order else '' }}">
                            <button type="button" id="btn-product-search" class="btn btn-sm btn-secondary mt-1">검색</button>
                        </div>
                        <div class="col-4"><label>품명</label><input type="text" class="form-control" id="product_name" name="product_name" value="{{ order.product_name if order else '' }}"></div>
                        <div class="col-2"><label>색상</label><select class="form-select" id="color" name="color"><option value="{{ order.color }}">{{ order.color }}</option></select></div>
                        <div class="col-2"><label>사이즈</label><select class="form-select" id="size" name="size"><option value="{{ order.size }}">{{ order.size }}</option></select></div>
                    </div>
                    <div id="product-search-results" class="list-group mt-2"></div>
                    
                    <div class="mt-3">
                        <label>처리현황</label>
                        <select class="form-select" name="order_status">
                            {% for s in order_statuses %}
                            <option value="{{ s }}" {{ 'selected' if order and order.order_status==s else '' }}>{{ s }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="card-footer">
                    <button type="submit" class="btn btn-primary">저장</button>
                    {% if order %}<button type="button" class="btn btn-danger" id="btn-delete-order">삭제</button>{% endif %}
                </div>
            </form>
            {% if order %}
            <form id="delete-order-form" action="{{ url_for('order.delete_order_view', order_id=order.id) }}" method="POST" style="display:none;">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            </form>
            {% endif %}
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/order.js') }}"></script>
</body>
</html>